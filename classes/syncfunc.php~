<?php
header("content-type: text/html; charset=utf-8");

function showauswahl($menu,$database,$onlyshow) {
  $db = new SQLite3('../data/'.$database);
  $qry = "SELECT * FROM tbltable";
  $results = $db->query($qry);
  $anztables=0;
  $arrvontables = array();
  $arrnchtables = array();
  $arrvonindex = array();
  $arrnchindex = array();
  $arrvonbez = array();
  $arrnchbez = array();
  $arrnchwebsite = array();
  $arrvondbtyp = array();
  $arrnchdbtyp = array();
  $arrvondbname = array();
  $arrvondbuser = array();
  $arrvondbpassword = array();
  while ($line = $results->fetchArray()) {
    $aktiv=$line['fldaktiv'];
    if ($aktiv=='J') {
      $anztables=$anztables+1;
      array_push($arrvontables,$line['fldvontblname']);
      array_push($arrnchtables,$line['fldnachtblname']);
      array_push($arrvonindex,$line['fldvontblindex']);
      array_push($arrnchindex,$line['fldnachtblindex']);
      array_push($arrvonbez,$line['fldvontblbez']);
      array_push($arrnchbez,$line['fldnachtblbez']);
      $qrydb = "SELECT * FROM tbldatabase WHERE fldindex=".$line['fldid_vondatabase'];
      $resdb = $db->query($qrydb);
      $lindb = $resdb->fetchArray();
      array_push($arrvondbtyp,$lindb['flddbtyp']);
      array_push($arrvondbname,$lindb['fldbez']);
      array_push($arrvondbuser,$lindb['flddbuser']);
      array_push($arrvondbpassword,$lindb['flddbpassword']);
      $qrydb = "SELECT * FROM tbldatabase WHERE fldindex=".$line['fldid_nachdatabase'];
      //echo $qrydb."<br>";
      $resdb = $db->query($qrydb);
      $lindb = $resdb->fetchArray();
      //echo $lindb['fldpfad'];
      array_push($arrnchwebsite,$lindb['fldpfad']);
      array_push($arrnchdbtyp,$lindb['flddbtyp']);
    }
  }  

  if ($anztables==0) {
    echo "<div class='alert alert-warning'>";
    echo "Keine Tables zum synchronisieren aktiviert.";
    echo "</div>";
  } else {
    $strvontables=json_encode($arrvontables);
    $strnchtables=json_encode($arrnchtables);
    $strvonindex=json_encode($arrvonindex);
    $strnchindex=json_encode($arrnchindex);
    $strvonbez=json_encode($arrvonbez);
    $strnchbez=json_encode($arrnchbez);
    $strnchwebsite=json_encode($arrnchwebsite);
    $strvondbtyp=json_encode($arrvondbtyp);
    $strnchdbtyp=json_encode($arrnchdbtyp);
    $strvondbname=json_encode($arrvondbname);
    $strvondbuser=json_encode($arrvondbuser);
    $strvondbpassword=json_encode($arrvondbpassword);
    //echo $strnchindex."<br>";
    $value="Anzeige starten";
    if ($onlyshow=="N") {
      $value="Sync starten";
    }
    echo "<form class='form-horizontal' method='post' action='sync.php?showsync=1&menu=".$menu."&onlyshow=".$onlyshow."'>";
    echo "<select name='typ' size='1'>";
    echo "<option style='background-color:#c0c0c0;' selected>local</option>";
    echo "<option style='background-color:#c0c0c0;' >remote</option>";
    echo "</select>";
    echo "<input type='hidden' name='status' value='sync' />";
    echo "<input type='hidden' name='anztables' value=".$anztables." />";
    echo "<input type='hidden' name='strvontables' value=".$strvontables." />";
    echo "<input type='hidden' name='strnchtables' value=".$strnchtables." />";
    echo "<input type='hidden' name='strvonindex' value=".$strvonindex." />";
    echo "<input type='hidden' name='strnchindex' value=".$strnchindex." />";
    echo "<input type='hidden' name='strvonbez' value=".$strvonbez." />";
    echo "<input type='hidden' name='strnchbez' value=".$strnchbez." />";
    echo "<input type='hidden' name='strnchwebsite' value=".$strnchwebsite." />";
    echo "<input type='hidden' name='strvondbtyp' value=".$strvondbtyp." />";
    echo "<input type='hidden' name='strnchdbtyp' value=".$strnchdbtyp." />";
    echo "<input type='hidden' name='strvondbname' value=".$strvondbname." />";
    echo "<input type='hidden' name='strvondbuser' value=".$strvondbuser." />";
    echo "<input type='hidden' name='strvondbpassword' value=".$strvondbpassword." />";
    echo "<dd><input type='submit' value='".$value."' /></dd>";
    echo "</form>";
  }	
  
	
}
 
function showsynclocal($menu,$database,$pfad,$onlyshow) {
  $db = new SQLite3('../data/'.$database);
  $qry = "SELECT * FROM tbltable";
  $results = $db->query($qry);


  echo "<br>";
  //echo "<div class='alert alert-info'>";
  //echo "onlyshow=".$onlyshow;
  //echo "</div>";
  while ($line = $results->fetchArray()) {
    $aktiv=$line['fldaktiv'];
    if ($aktiv=='J') {
      $dbvonid=$line['fldid_vondatabase'];
      $qryvondb = "SELECT * FROM tbldatabase WHERE fldindex=".$dbvonid;
      $resvondb = $db->query($qryvondb);
      if ($linvondb = $resvondb->fetchArray()) {
        $dbvontyp=$linvondb['flddbtyp'];

      }
      $dbvontable=$line['fldvontblname'];
      $dbtable=$line['fldvontblname'];
      //echo $dbtable."<br>";

      $dbtyp="MYSQL";
      $dblocal="dbjoorgportal";
      $dbuser="root";
      $dbpassword="mysql";

  $dbsyncnr=1;
  $qryval = "SELECT * FROM tblsyncstatus WHERE flddbsyncnr=".$dbsyncnr." and fldtable='".$dbtable."'";
  echo $qryval."<br>";
  $results = dbquerytyp('SQLITE3',$db,$qryval);
  if ($linval = dbfetchtyp('SQLITE3',$results)) {
      $timestamp=$linval['fldtimestamp'];
  } else {
      $timestamp="2015-01-01 06:00:00";
  }
  echo $timestamp."<br>";

  $website="allnosync.php?menu=".$menu;
  echo "<form class='form-horizontal' method='post' action='".$website."'>";
  echo "<input type='submit' value='All NoSync' />";
  echo "<input type='hidden' name='pfad' value='".$pfad."' />";
  echo "<input type='hidden' name='dbvontyp' value='".$dbvontyp."' />";
  echo "<input type='hidden' name='dbtable' value='".$dbtable."' />";
  echo "<input type='hidden' name='database' value='".$dblocal."' />";
  echo "<input type='hidden' name='dbuser' value='".$dbuser."' />";
  echo "<input type='hidden' name='dbpassword' value='".$dbpassword."' />";
  echo "<input type='hidden' name='dbsyncnr' value='".$dbsyncnr."' />";
  echo "<input type='hidden' name='timestamp' value='".$timestamp."' />";
  echo "</form>";	


  echo "<table>";
  echo "<tr><td>Pfad</td><td> : ".$pfad."</td></tr>";
  echo "<tr><td>Datenbank</td><td> : ".$dblocal."</td></tr>";
  echo "<tr><td>Table</td><td> : ".$dbtable."</td></tr>";
  echo "<tr><td>dbsyncnr</td><td> : ".$dbsyncnr."</td></tr>";
  echo "<tr><td>timestamp</td><td> : ".$timestamp."</td></tr>";
  echo "</table>";


      if ($onlyshow=="N") {
        echo "<form class='form-horizontal' method='post' action='sync.php?menu=".$menu."'>";
        echo "<dd><input type='submit' value='Daten senden' /></dd>";
      }
      
          
        $dbopen=dbopentyp($dbvontyp,$dblocal,$dbuser,$dbpassword);
        $col = "";
        $lincnt = 1;
        $count = 0;
  		  $query="SHOW COLUMNS FROM ".$dbtable;
          $results = dbquerytyp($dbtyp,$dbopen,$query);
          $arrcol = array();
          while ($row = dbfetchtyp($dbtyp,$results)) {
            $colstr=$row['Field'];
            $lincnt = $lincnt + 1;
            $arrcol[] = $colstr;
            if ($col=="") {
              $col=$colstr;
            } else {	
              $col=$col.",".$colstr;
            }    
		  }
      
      
      $dblocalopen=dbopentyp($dbvontyp,$dblocal,$dbuser,$dbpassword);
      $colsel="*";
      $dbsyncnr="1";
      $qryval = "SELECT ".$colsel." FROM ".$dbtable." WHERE fldtimestamp>'".$timestamp."' AND flddbsyncnr=".$dbsyncnr." AND flddbsyncstatus='SYNC'";
	   echo $qryval."<br>";
      $resval = dbquerytyp($dbvontyp,$dblocalopen,$qryval);
      $datcnt=0;
      $dbindex="fldIndex";
      echo "<table class='table table-hover'>";
      echo "<tr><th>dummy</th><th>NOSYNC</th></tr>";
      while ($linval = dbfetchtyp($dbtyp,$resval)) {
        echo "<tr>";
        echo "<td>";
        echo $linval[1];
        echo "</td>";
        //echo "<td>NOSYNC</td>";
        echo "<td><a href='nosync.php?menu=".$menu."&dbindex=".$linval[0]."' class='btn btn-primary btn-sm active' role='button'>NOSYNC</a></td> ";
        echo "</tr>";
        
        $val = "#".$linval[0]."#";
        $updsql=$arrcol[0]."=#".$linval[0]."#";
        for($lincount = 1; $lincount+1 < $lincnt; $lincount++) {
          $val = $val . ",#".$linval[$lincount]."#";
          $updsql = $updsql.",".$arrcol[$lincount]."=#".$linval[$lincount]."#";
        }
        $datcnt=$datcnt+1;
        $index=$linval[$dbindex];
        $updsql="UPDATE ".$dbtable." SET ".$updsql." WHERE ".$dbindex."=".$index;
        $inssql = "INSERT INTO ".$dbtable."(".$col.") VALUES (".$val.");";
        echo "<input type='hidden' name='index".$datcnt."' value='".$index."'/>";
        echo "<input type='hidden' name='updsql".$datcnt."' value='".$updsql."'/>";
        echo "<input type='hidden' name='inssql".$datcnt."' value='".$inssql."'/>";
        
      }
      echo "<input type='hidden' name='datcnt' value='".$datcnt."'/>";
      echo "<input type='hidden' name='dbtable' value='".$dbtable."'/>";
      echo "</table>";
      
      if ($onlyshow=="N") {
        echo "<input type='hidden' name='status' value='senden' />";
        echo "</form>";
      }      
    }
  }  

}

function showsyncremote($menu,$database,$pfad) {
  echo "<br><br>";	
  $remotedatabase="/var/www/html/own/joorgsqlite/data/joorgsqlite.db";
  $dbtable="tblfahrtenbuch";
  $fldindex="fldindex";
  $website="http://localhost/own/phpmysyncremote/classes/syncremote.php?menu=".$menu."&dbtable=".$dbtable."&showsync=J";	
  echo "<div class='alert alert-info'>";
  //echo $website."<br>";
  echo "<table>";
  echo "<tr><td>website</td><td> : ".$website."</td></tr>";
  echo "<tr><td>Pfad</td><td> : ".$pfad."</td></tr>";
  echo "<tr><td>Datenbank</td><td> : ".$remotedatabase."</td></tr>";
  echo "<tr><td>Table</td><td> : ".$dbtable."</td></tr>";
  echo "<tr><td>fldindex</td><td> : ".$fldindex."</td></tr>";
  echo "</table>";
  echo "</div>";
  echo "<form class='form-horizontal' method='post' action='".$website."'>";
  echo "<input type='hidden' name='pfad' value='".$pfad."' />";
  echo "<input type='hidden' name='database' value='".$remotedatabase."' />";
  echo "<input type='hidden' name='fldindex' value='".$fldindex."' />";
  echo "<dd><input type='submit' value='Daten zeigen' /></dd>";
  echo "</form>";

}

function syncsenden($database,$datcnt,$dbtypVon,$dbtable) {
  echo $datcnt."x syncsenden<br>";
  $fldindexNch="fldIndex";
  $dbtypNch="SQLITE3";
  $dbaseNch="/var/www/html/own/joorgsqlite/data/joorgsqlite.db";
  $dbuserNch="";
  $dbpasswordNch="";
  $dbNch=dbopentyp($dbtypNch,$dbaseNch,$dbuserNch,$dbpasswordNch);

  //$fldindexVon="fldIndex";
  //$dbtyp="MYSQL";
  //$dbaseVon="dbjoorgportal";
  //$dbuserVon="root";
  //$dbpasswordVon="mysql";
  //$dbVon=dbopentyp($dbtypVon,$dbaseVon,$dbuserVon,$dbpasswordVon);
  for($cnt = 1; $cnt <= $datcnt; $cnt++) {
  	
    $index=$_POST['index'.$cnt];
    $qryval = "SELECT * FROM ".$dbtable." WHERE ".$fldindexNch."=".$index;
	 echo $qryval."<br>";
    $results = dbquerytyp($dbtypNch,$dbNch,$qryval);
    if ($linval = dbfetchtyp($dbtypNch,$results)) {
    	 echo $_POST['index'.$datcnt]."<br>";
    	 $sql=$_POST['updsql'.$datcnt];
  	    $sql=str_replace("#","'",$sql);
  	 } else {  
  	   echo $sql."<br>";
  	   $sql=$_POST['inssql'.$datcnt];
  	   $sql=str_replace("#","'",$sql);
  	 }  
  	 echo $sql."<br>";
  	 dbexecutetyp($dbtypNch,$dbNch,$sql);
  	 //$qryupd="UPDATE ".$dbtable." SET flddbsyncstatus='NOSYNC' WHERE fldindex=".$index;
  	 //echo $qryupd."<br>";
  	 //dbexecutetyp($dbtyploc,$dblocal,$qryupd);
  }  
//  $db = new SQLite3('../data/'.$database);
  $db=dbopentyp('SQLITE3','../data/'.$database,'','');
  $datetime = new DateTime();
  $timestamp=$datetime->format('Y-m-d H:i:s');  
  echo $timestamp."=timestamp<br>";
  $qryval = "SELECT * FROM tblsyncstatus WHERE flddbsyncnr=1 and fldtable='".$dbtable."'";
  echo $qryval."<br>";
  $results = dbquerytyp('SQLITE3',$db,$qryval);
  if ($linval = dbfetchtyp('SQLITE3',$results)) {
    $sql="UPDATE tblsyncstatus SET fldtimestamp='".$timestamp."' WHERE fldtable='".$dbtable."' and flddbsyncnr=1";
  } else {
    $sql="INSERT INTO tblsyncstatus (fldtable,fldtimestamp,flddbsyncnr) VALUES('".$dbtable."','".$timestamp."',1)";
  }
  echo $sql."<br>";
  dbexecutetyp('SQLITE3',$db,$sql);
}

function auslesen($menu,$onlyshow) {
  echo "<div class='alert alert-success'>";
  echo "Auslesen<br><br>";
  echo "</div>";

//  $websitetest="http://localhost/own/phpmysync/classes/syncremote.php?menu=".$menu;
  $aktpfad=$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'];  
  $callbackurl="http://".$aktpfad."?menu=".$menu;
  $anztables=$_POST["anztables"];
  $arrvontables=json_decode($_POST["strvontables"]);
  $strvontables=$arrvontables[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvontables=$strvontables.",".$arrvontables[$tablecount];
  }
  $arrnchtables=json_decode($_POST["strnchtables"]);
  $strnchtables=$arrnchtables[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchtables=$strnchtables.",".$arrnchtables[$tablecount];
  }
  $arrvonindex=json_decode($_POST["strvonindex"]);
  $strvonindex=$arrvonindex[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvonindex=$strvonindex.",".$arrvonindex[$tablecount];
  }
  $arrnchindex=json_decode($_POST["strnchindex"]);
  $strnchindex=$arrnchindex[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchindex=$strnchindex.",".$arrnchindex[$tablecount];
  }
  $arrvonbez=json_decode($_POST["strvonbez"]);
  $strvonbez=$arrvonbez[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvonbez=$strvonbez.",".$arrvonbez[$tablecount];
  }
  $arrnchbez=json_decode($_POST["strnchbez"]);
  $strnchbez=$arrnchbez[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchbez=$strnchbez.",".$arrnchbez[$tablecount];
  }
  $arrnchwebsite=json_decode($_POST["strnchwebsite"]);
  $strnchwebsite=$arrnchwebsite[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchwebsite=$strnchwebsite.",".$arrnchwebsite[$tablecount];
  }
  $website=$arrnchwebsite[0]."classes/syncremote.php?menu=".$menu;
  $arrvondbtyp=json_decode($_POST["strvondbtyp"]);
  $strvondbtyp=$arrvondbtyp[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvondbtyp=$strvondbtyp.",".$arrvondbtyp[$tablecount];
  }
  $arrnchdbtyp=json_decode($_POST["strnchdbtyp"]);
  $strnchdbtyp=$arrnchdbtyp[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchdbtyp=$strnchdbtyp.",".$arrnchdbtyp[$tablecount];
  }
  $arrvondbname=json_decode($_POST["strvondbname"]);
  $strvondbname=$arrvondbname[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvondbname=$strvondbname.",".$arrvondbname[$tablecount];
  }
  $arrnchdbname=json_decode($_POST["strnchdbname"]);
  $strnchdbname=$arrnchdbname[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strnchdbname=$strnchdbname.",".$arrnchdbname[$tablecount];
  }
  $arrvondbuser=json_decode($_POST["strvondbuser"]);
  $strvondbuser=$arrvondbuser[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvondbuser=$strvondbuser.",".$arrvondbuser[$tablecount];
  }
  $arrvondbpassword=json_decode($_POST["strvondbpassword"]);
  $strvondbpassword=$arrvondbpassword[0];
  for($tablecount = 1; $tablecount < $anztables; $tablecount++) {
  	 $strvondbpassword=$strvondbpassword.",".$arrvondbpassword[$tablecount];
  }
  

  echo "<div class='alert alert-info'>";
  echo "<table>";
//  echo "<tr><td>website (Test)</td><td> : ".$websitetest."</td></tr>";
  echo "<tr><td>website</td><td> : ".$website."</td></tr>";
//  echo "<tr><td>callbackurl</td><td> : ".$callbackurl."</td></tr>";
//  echo "<tr><td>menu</td><td> : ".$menu."</td></tr>";
//  echo "<tr><td>onlyshow</td><td> : ".$onlyshow."</td></tr>";
  echo "<tr><td>anztables</td><td> : ".$anztables."</td></tr>";
  echo "<tr><td>strvontables</td><td> : ".$strvontables."</td></tr>";
  echo "<tr><td>strvonindex</td><td> : ".$strvonindex."</td></tr>";
  echo "<tr><td>strvonbez</td><td> : ".$strvonbez."</td></tr>";
  echo "<tr><td>strvondbtyp</td><td> : ".$strvondbtyp."</td></tr>";
  echo "<tr><td>strvondbname</td><td> : ".$strvondbname."</td></tr>";
  echo "<tr><td>strvondbuser</td><td> : ".$strvondbuser."</td></tr>";
  echo "<tr><td>strvondbpassword</td><td> : ".$strvondbpassword."</td></tr>";
  echo "<tr><td>strnchtables</td><td> : ".$strnchtables."</td></tr>";
  echo "<tr><td>strnchindex</td><td> : ".$strnchindex."</td></tr>";
  echo "<tr><td>strnchbez</td><td> : ".$strnchbez."</td></tr>";
  echo "<tr><td>strnchdbtyp</td><td> : ".$strnchdbtyp."</td></tr>";
  echo "<tr><td>strnchdbname</td><td> : ".$strnchdbname."</td></tr>";
  echo "</table>";
  echo "</div>";

  $arrcolsel=array();
  for($tablecount = 0; $tablecount < $anztables; $tablecount++) {
    $column=getdbcolumn($arrvondbtyp[$tablecount],$arrvondbname[$tablecount],$arrvontables[$tablecount]);   
    array_push($arrcolsel,$column);
  }
  
  echo "<form class='form-horizontal' method='post' action='".$website."'>";
  echo "<input type='hidden' name='callbackurl' value='".$callbackurl."' />";
  echo "<input type='hidden' name='onlyshow' value='".$onlyshow."' />";
  echo "<input type='hidden' name='action' value='einspielen' />";
  echo "<input type='hidden' name='anztables' value=".$anztables." />";
  echo "<input type='hidden' name='strnchdbtyp' value=".json_encode($arrnchdbtyp)." />";
  echo "<input type='hidden' name='strnchdbname' value=".json_encode($arrnchdbname)." />";
  echo "<input type='hidden' name='strnchtables' value=".json_encode($arrnchtables)." />";
  echo "<input type='hidden' name='strnchindex' value=".json_encode($arrnchindex)." />";
  echo "<input type='submit' value='Daten einspielen' />";
  
  echo "<table class='table table-hover'>";
  echo "<tr><th>Table</th><th>Index</th><th>Bezeichnung</th><th>NOSYNC</th></tr>";
  //$qryval = "SELECT ".$colsel." FROM ".$dbtable." WHERE fldtimestamp>'".$timestamp."' AND flddbsyncnr=".$dbsyncnr." AND flddbsyncstatus='SYNC'";
  echo "<br>";
  $arranzds = array();
  $arridxds = array();
  for($tablecount = 0; $tablecount < $anztables; $tablecount++) {
    $dbvonopen=dbopentyp($arrvondbtyp[$tablecount],$arrvondbname[$tablecount],$arrvondbuser[$tablecount],$arrvondbpassword[$tablecount]);
    $qryval = "SELECT ".$arrcolsel[$tablecount]." FROM ".$arrvontables[$tablecount]." WHERE flddbsyncstatus='SYNC'";
    $resval = dbquerytyp($arrvondbtyp[$tablecount],$dbvonopen,$qryval);
	 $datcnt=0;
    while ($linval = dbfetchtyp($arrvondbtyp[$tablecount],$resval)) {
	   $datcnt=$datcnt+1;
      echo "<tr>";
      echo "<td>".$arrvontables[$tablecount]."</td>";
      echo "<td>".$linval[$arrvonindex[$tablecount]]."</td>";
      echo "<td>".$linval[$arrvonbez[$tablecount]]."</td>";
      echo "<td><a href='nosync.php?menu=".$menu."&dbindex=".$linval[$arrvonindex[$tablecount]]."' class='btn btn-primary btn-sm active' role='button'>NOSYNC</a></td> ";
      echo "</tr>";
      array_push($arridxds,$linval[$arrvonindex[$tablecount]]);
	 }  
	 array_push($arranzds,$datcnt);
  }	
  echo "</table>";  
  echo "<input type='hidden' name='stranzds' value=".json_encode($arranzds)." />";
  echo "<input type='hidden' name='stridxds' value=".json_encode($arridxds)." />";
  
  echo "</form>";
  
  
}

function fernabfrage($menu,$onlyshow) {
  echo "fernabfrage<br><br>";

  $website="http://localhost/own/phpmysync/classes/syncremote.php?menu=".$menu;
  $aktpfad=$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'];  
  $callbackurl="http://".$aktpfad."?menu=".$menu;

  echo "<div class='alert alert-info'>";
  echo "<table>";
  echo "<tr><td>website</td><td> : ".$website."</td></tr>";
  echo "<tr><td>callbackurl</td><td> : ".$callbackurl."</td></tr>";
  echo "<tr><td>menu</td><td> : ".$menu."</td></tr>";
  echo "<tr><td>onlyshow</td><td> : ".$onlyshow."</td></tr>";
  echo "</table>";
  echo "</div>";
  
  echo "<form class='form-horizontal' method='post' action='".$website."'>";
  echo "<input type='hidden' name='callbackurl' value='".$callbackurl."' />";
  echo "<input type='hidden' name='onlyshow' value='".$onlyshow."' />";
  echo "<input type='hidden' name='action' value='auslesen' />";
  echo "<input type='submit' value='Daten auslesen' />";
  echo "</form>";
  
}

function einspielen($onlyshow) {
  echo "einspielen<br><br>";
  echo "<div class='alert alert-info'>";
  echo "<table>";
  echo "<tr><td>onlyshow</td><td> : ".$onlyshow."</td></tr>";
  echo "</table>";
  echo "</div>";

  echo "abschliessen<br>";
}

function abschliessen($onlyshow) {
  echo "<br>";	
  echo "<div class='alert alert-info'>";
  if ($onlyshow=="J") {
    echo "Datenanzeige abgeschlossen.<br>";	
  } else {
    echo "Timestamp: 12:00<br>";
    echo "Datensynchronisation abgeschlossen.<br>";	
  }
  echo "onlyshow=".$onlyshow."<br>";	
  echo "</div>";
}

?>